import * as jscad from '@jscad/modeling';

const { cube, sphere, cylinder } = jscad.primitives;
const { translate, rotate } = jscad.transforms;
const { union, subtract } = jscad.booleans;
const { colorize } = jscad.colors;

/**
 * Create a simple screw
 */
export function screw(length = 30, diameter = 6, headDiameter = 10) {
  const shaft = cylinder({ radius: diameter / 2, height: length });
  const head = translate(
    [0, 0, length / 2],
    cylinder({ radius: headDiameter / 2, height: 3 })
  );

  return colorize([0.6, 0.6, 0.6], union(shaft, head));
}

/**
 * Create a bearing
 */
export function bearing(outerD = 20, innerD = 10, thickness = 5) {
  const outer = cylinder({ radius: outerD / 2, height: thickness });
  const inner = cylinder({ radius: innerD / 2, height: thickness + 1 });

  return colorize([0.5, 0.5, 0.6], subtract(outer, inner));
}


function render(result, el) {
  // Skip null/undefined
  if (result === null || result === undefined) return;
  // Handle function exports (render function that takes container ID)
  if (typeof result === "function") {
    result(el.id);
  }
  // Handle HTMLElement exports
  else if (result instanceof HTMLElement) {
    if (!el.hasChildNodes()) el.appendChild(result);
  }
  // Handle string exports (could be HTML or plain text)
  else if (typeof result === "string") {
    if (result.trim().startsWith("<")) {
      el.innerHTML = result;
    } else {
      el.textContent = result;
    }
  }
  // Handle numbers and booleans
  else if (typeof result === "number" || typeof result === "boolean") {
    el.textContent = String(result);
  }
  // Handle objects/arrays (display as formatted JSON)
  else if (typeof result === "object") {
    el.innerHTML = "<pre>" + JSON.stringify(result, null, 2) + "</pre>";
  }
}
export { render };