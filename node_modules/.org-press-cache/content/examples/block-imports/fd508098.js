// Import server-computed file statistics and date
import fileStats from './block-import-library.org?name=file-stats';
import currentDate from './block-import-library.org?name=current-date';

const container = document.createElement('div');
container.style.cssText = 'padding: 1rem; background: #e0f2f1; border-radius: 8px; margin: 1rem 0;';

const stats = JSON.parse(fileStats);

container.innerHTML = `
  <h4 style="margin-top: 0; color: #00796b;">Server-Side Data from Library</h4>
  <p><strong>Build Date:</strong> ${currentDate}</p>
  <p><strong>Total org files:</strong> ${stats.totalFiles}</p>
  <details>
    <summary style="cursor: pointer; color: #00796b; font-weight: bold;">File Details</summary>
    <ul>
      ${stats.files.map(f => `<li>${f.name} - ${(f.size / 1024).toFixed(2)} KB</li>`).join('')}
    </ul>
  </details>
`;

export default container;


function render(result, el) {
  // Skip null/undefined
  if (result === null || result === undefined) return;
  // Handle function exports (render function that takes container ID)
  if (typeof result === "function") {
    result(el.id);
  }
  // Handle HTMLElement exports
  else if (result instanceof HTMLElement) {
    if (!el.hasChildNodes()) el.appendChild(result);
  }
  // Handle string exports (could be HTML or plain text)
  else if (typeof result === "string") {
    if (result.trim().startsWith("<")) {
      el.innerHTML = result;
    } else {
      el.textContent = result;
    }
  }
  // Handle numbers and booleans
  else if (typeof result === "number" || typeof result === "boolean") {
    el.textContent = String(result);
  }
  // Handle objects/arrays (display as formatted JSON)
  else if (typeof result === "object") {
    el.innerHTML = "<pre>" + JSON.stringify(result, null, 2) + "</pre>";
  }
}
export { render };